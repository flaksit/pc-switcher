# PC-switcher configuration file
# Location: ~/.config/pc-switcher/config.yaml
# Documentation: https://github.com/flaksit/pc-switcher

# =============================================================================
# Logging Configuration (3-setting model)
# =============================================================================
# Controls where log messages appear based on their severity level.
#
# Log levels (from most to least verbose):
#   DEBUG (10)    - Internal diagnostics, very verbose
#   FULL (15)     - Operational details (file-level sync info)
#   INFO (20)     - High-level progress and status updates
#   WARNING (30)  - Unexpected but non-fatal conditions
#   ERROR (40)    - Recoverable errors
#   CRITICAL (50) - Unrecoverable errors, sync must abort

logging:
  # file: Floor level for log FILE output (~/.local/share/pc-switcher/logs/)
  #       Messages at or above this level are written to the log file.
  file: DEBUG

  # tui: Floor level for TERMINAL output during sync
  #      Messages at or above this level are shown in the terminal UI.
  tui: INFO

  # external: Additional floor for THIRD-PARTY libraries (asyncssh, etc.)
  #           External library logs must pass BOTH this floor AND the
  #           destination floor (file or tui) to appear in output.
  #           Use DEBUG to see SSH connection details, WARNING to suppress noise.
  external: WARNING

# =============================================================================
# Sync Jobs Configuration
# =============================================================================
# Enable or disable optional sync jobs
# Note: Only jobs explicitly listed here will be discovered and run
# Set to false to disable a job (e.g., dummy_fail: false)

sync_jobs:
  # Test jobs (for development/testing)
  dummy_success: true    # Test job that completes successfully
  dummy_fail: false      # Test job that fails at configurable progress

  # Future jobs (uncomment when available):
  # user_data: true       # Sync /home and /root directories
  # packages: true        # Sync apt, snap, flatpak packages
  # docker: false         # Sync Docker images, containers, volumes
  # vms: false            # Sync KVM/virt-manager VMs
  # k3s: false            # Sync k3s cluster state

# =============================================================================
# Disk Space Monitoring
# =============================================================================
# Configuration for disk space checks before and during sync
# Threshold format: percentage (e.g., "20%") or absolute (e.g., "50GiB")

disk_space_monitor:
  # Minimum free space required before sync starts
  preflight_minimum: "20%"

  # Minimum free space required during sync (CRITICAL - abort if below)
  runtime_minimum: "15%"

  # Free space threshold for warnings during sync
  warning_threshold: "25%"

  # Seconds between disk space checks during sync
  check_interval: 30

# =============================================================================
# Btrfs Snapshot Management
# =============================================================================
# Configuration for automatic btrfs snapshots before and after sync
# IMPORTANT: Subvolumes must match YOUR system's btrfs layout

btrfs_snapshots:
  # List of btrfs subvolumes to snapshot
  # Check your system: sudo btrfs subvolume list /
  # Common layouts:
  #   - Ubuntu default: ["@", "@home"]
  #   - Single root: ["@"]
  subvolumes:
    - "@"
    - "@home"

  # Number of recent sync sessions to always retain snapshots for,
  # irrespective of age (max_age_days below)
  keep_recent: 3

  # Maximum age in days for snapshot retention (optional)
  # Note that always keeping 'keep_recent' snapshots takes precedence.
  # Uncomment to enable age-based cleanup:
  # max_age_days: 7

# =============================================================================
# Job-Specific Configuration
# =============================================================================
# Each sync job can have its own configuration section
# Configuration keys must match the job name

# Test job configurations (examples)
dummy_success:
  source_duration: 20    # Seconds to run on source machine
  target_duration: 20    # Seconds to run on target machine

dummy_fail:
  source_duration: 10    # Seconds to run on source machine
  target_duration: 10    # Seconds to run on target machine
  fail_at: 12            # Elapsed seconds at which to fail

# Future job configurations will be added here when features are implemented:
